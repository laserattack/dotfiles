#!/usr/bin/env perl

use strict;
use warnings;
use File::Basename;
use feature 'say';

our $anyext = qr/\.[^.]*$/;

sub cloakdir {
    my ($path) = @_;
    my $name = basename($path);
    say "name = $name";
}

sub cloakfile {
    my ($path) = @_;
    my ($name, undef, $suffix) = fileparse($path, $anyext);
    say "name = $name, suffix = $suffix";
}

sub cloak {
    my ($arg) = @_;
    if (-f $arg) {
        cloakfile($arg);
    } elsif (-d $arg) {
        cloakdir($arg);
    } else {
        die "[ERROR] '$arg' is not a file or dir\n"
    }
}

if (@ARGV < 1) {
    say 'cloak porno      # encrypt file/dir';
    say 'cloak porno.enc  # decrypt file';
} else {
    foreach my $arg (@ARGV) {
        cloak($arg);
    }
}
